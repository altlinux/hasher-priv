.\" $Id$
.\" Copyright (C) 2004, 2005  Dmitry V. Levin <ldv@altlinux.org>
.\" 
.\" Documentation for the hasher-priv program.
.\"
.\" This file is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\" 
.\" This program is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
.\" GNU General Public License for more details.
.\" 
.\" You should have received a copy of the GNU General Public License
.\" along with this program; if not, write to the Free Software
.\" Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA.

[NAME]
\fBhasher-priv\fR \- privileged helper for the hasher project

[FILES]
.TP
.I /etc/hasher\-priv/system
systemwide config file
.TP
\fI/etc/hasher\-priv/user.d/\fBUSER\fR
per-user config files
.TP
\fI/etc/hasher\-priv/user.d/\fBUSER\fI:\fBNUMBER\fR
per-user per-number subconfig files

[ENVIRONMENT]
The following environment variables are processed by
.BR hasher\-priv:
.TP
.B wlimit_time_elapsed
Define total execution time limit, in seconds.
If
.B wlimit_time_elapsed
config parameter is also set, then minimal value will be used.
.TP
.B wlimit_time_idle
Define idle time limit, in seconds.
Idle time is a period when child process produces no output.
If
.B wlimit_time_idle
config parameter is also set, then minimal value will be used.
.TP
.B wlimit_bytes_written
Define limit of output generated by child process, in bytes.
If
.B wlimit_bytes_written
config parameter is also set, then minimal value will be used.
.TP
.B use_pty
This boolean specifies whether stdin, stdout and stderr of child process
will be redirected to controlling pseudoterminal created by
.BR hasher\-priv.
By default, stdin remains unchanged unless it references to terminal
device, and stdout with stderr are redirected to pipe created by
.BR hasher\-priv.
.TP
.B TERM
This variable will be passed to child process if
.B use_pty
is set to true.

[SECURITY]
Following operation modes are not security sensitive:
.TP
.BR getugid1 ", " getugid2
Query pseudouser identifiers.
.PP
Following operation modes have minimal security implications:
.TP
.BR killuid1 ", " killuid2
Kill all processes running by pseudousers.
.TP
.BR chrootuid1 ", " chrootuid2
Execute program in build chroot with credentials of pseudouser.
.PP
Following operation modes have medium security implications:
.TP
.B makedev
Create essential device files available for all users:
\fInull\fR, \fIzero\fR and \fIurandom\fR.
Using this operation mode, caller user may populate file system with
these devices.  While \fInull\fR and \fIzero\fR cause no harm for OS,
pseudousers may abuse \fIurandom\fR to cause host system randomness
starvation.
.PP
Following operation modes have high security implications:
.TP
.B maketty
Create terminal device files: \fItty\fR (current tty device) and
\fIptmx\fR (PTY master multiplex).  Using this operation mode, caller
user may populate file system with these devices.  While \fItty\fR causes
no harm for OS, pseudousers may abuse \fIptmx\fR to exhaust OS pty limit
and therefore install DoS attack against host system.
.TP
.B mount
Mount appropriate file system according to specified mount point.
for example, proc and sysfs virtual file systems provide access to various
system resources which could be abused by pseudousers, devpts virtual
file system provides access to all pty device files which also could be
abused by pseudousers if these files have inappropriate permissions.
.TP
.B umount
Umount all file systems previously mounted by
\*(lq\fBhasher\-priv\fR mount\*(rq.  Unless appropriate
.I prefix
config option is set, this command may be abused by calling user to
unmount essential file systems and therefore install DoS attack against
host system.

.PP
All risky operation modes are not enabled by default.  They could be
explicitly enabled in
.B hasher\-priv
configuration.

[SEE ALSO]
.BR hasher\-priv.conf (5),
.BR hasher (7),
.BR hasher\-useradd (8).
